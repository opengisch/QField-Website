<!doctype html>
<html lang="en" data-bs-theme="dark"> 
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=34643&amp;path=livereload" data-no-instant defer></script>
    


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
<meta http-equiv='Content-Security-Policy' content="script-src 'self'; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'none'">
    

<link rel="stylesheet" href="/css/style.css" media="screen">

<link rel="stylesheet" href="/bootstrap-icons/bootstrap-icons.004322721c8557331759bc6ddaacbb689b0f0715d688aec82bd056d2d5b5cc3b.css">
    <title>How we build QField for many platforms - A look behind the curtain</title>

<meta name="description" content="In the past year, the build system behind QField has been ported to vcpkg, a modern C&#43;&#43; dependency management system. It has been a great success for QField and considerably helped to streamline efforts, improve the development experience and to guarantee an outstanding stability of the application. In this blog post we will look at the history of building QGIS based applications for mobile systems and how it has become what it is today.
">
  


<link rel="canonical" href="http://localhost:34643/2022/09/20/how-we-build-qfield-for-many-platforms-a-look-behind-the-curtain/">


<link rel="alternate" hreflang="en" href="http://localhost:34643/2022/09/20/how-we-build-qfield-for-many-platforms-a-look-behind-the-curtain/">



<link rel="alternate" hreflang="x-default" href="http://localhost:34643/2022/09/20/how-we-build-qfield-for-many-platforms-a-look-behind-the-curtain/">












<meta property="og:title" content="How we build QField for many platforms - A look behind the curtain">
<meta property="og:description" content="In the past year, the build system behind QField has been ported to vcpkg, a modern C&#43;&#43; dependency management system. It has been a great success for QField and considerably helped to streamline efforts, improve the development experience and to guarantee an outstanding stability of the application. In this blog post we will look at the history of building QGIS based applications for mobile systems and how it has become what it is today.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://localhost:34643/2022/09/20/how-we-build-qfield-for-many-platforms-a-look-behind-the-curtain/">
  <meta property="article:section" content="blog">
  
    <meta property="article:published_time" content="2022-09-20T05:48:00+00:00">
  
  
    <meta property="article:modified_time" content="2022-09-20T05:48:00+00:00">
  
  <meta property="og:site_name" content="QField - Efficient field work built for QGIS">










<meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How we build QField for many platforms - A look behind the curtain">
<meta name="twitter:description" content="In the past year, the build system behind QField has been ported to vcpkg, a modern C&#43;&#43; dependency management system. It has been a great success for QField and considerably helped to streamline efforts, improve the development experience and to guarantee an outstanding stability of the application. In this blog post we will look at the history of building QGIS based applications for mobile systems and how it has become what it is today.">






  





<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "How we build QField for many platforms - A look behind the curtain",
  "datePublished": "2022-09-20T05:48:00+00:00",
  "dateModified": "2022-09-20T05:48:00+00:00",
  "mainEntityOfPage": "http://localhost:34643/",
  "publisher": {
    "@type": "Organization",
    "name": "QField - Efficient field work built for QGIS"
  },
  "wordcount" :  863 ,
  "description": "In the past year, the build system behind QField has been ported to vcpkg, a modern C++ dependency management system. It has been a great success for QField and considerably helped to streamline efforts, improve the development experience and to guarantee an outstanding stability of the application. In this blog post we will look at the history of building QGIS based applications for mobile systems and how it has become what it is today.\n",
  "keywords":  null 
}
</script>












    


</head>

<body class="blog single d-flex flex-column min-vh-100"><header class="main-header">
  <nav class="navbar navbar-expand-lg bg-body border-bottom sticky-top mb-4">
    <div class="container">

      
      <a class="navbar-brand fw-bold d-flex align-items-center" href="/">
        
        QField - Efficient field work built for QGIS
      </a>

      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="d-flex order-lg-2 ms-auto align-items-center gap-2">
        <a class="btn btn-danger d-none d-lg-inline" href=""></a>
        <button class="navbar-toggler ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="menu-main navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/#highlights">Features</a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/success-stories/">Success Stories</a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="https://docs.qfield.org">Documentation</a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/support-us/">Support</a>
          </li>
          
          </ul>

        
        
        

      </div>
    </div>
  </nav>
</header><div id="content">
        

<div class="container py-3">
  <p><em>In the past year, <strong>the build system behind QField has been ported to <a href="https://vcpkg.io/en/index.html" target="_blank" rel="noopener">vcpkg, a modern C++ dependency management system</a></strong>. It has been a great success for QField and considerably helped to streamline efforts, improve the development experience and to guarantee an outstanding stability of the application. In this blog post we will look at the history of building QGIS based applications for mobile systems and how it has become what it is today.</em></p>
<p>When <a href="/2011/08/24/gsoc-2011-final-report/">Marco Bernasocchi (CEO of OPENGIS.ch and chair of QGIS.org) started working on <strong>QGIS for Android</strong> in Google Summer of Code</a> a decade ago, the main job was to also build all QGIS dependencies for Android. This includes well-known libraries like <strong>proj</strong> and <strong>gdal</strong> and less-known ones like libxml2 or iconv. Each of them has its particularities and specific build flags. Working on this appears to be an endless iterative trial-and-error journey where you hope each day that eventually you will see the <a href="/2021/06/08/qfieldcloud-now-opensource-happy-10-years-of-field-mapping-with-qgis/">QGIS splash screen on your Android phone</a> while all you see are endless lines of code and compiler errors.</p>
<p>As we know nowadays QGIS for Android has eventually seen the sunlight and its achievements are still the base for <a href="https://qfield.org/" target="_blank" rel="noopener">QGIS-based mobile apps like QField</a>.</p>
<p>Sometime later we decided to modernize the build infrastructure into OSGeo4A a set of scripts where each dependency was built with a &ldquo;recipe&rdquo;. Modularized this way, it was easier to maintain, and general build code common for all libraries could be isolated. It was good enough to help drive QField for a couple of years, and a copy of it is still in use <strong>as the base for nowadays <a href="https://github.com/qgis/QGIS-Mac-Packager/tree/master/qgis_deps" target="_blank" rel="noopener">QGIS builds for macOS</a></strong>.</p>
<p>When we decided to make QField also available on other platforms like <strong>iOS, Windows and macOS</strong> we quickly realized that duplicating build chains scales really bad and maintaining this is an immense effort we wanted to avoid. There are a couple of existing C++ dependency management systems, none of which convinced us ultimately. Lucky for us a mail on the <a href="https://www.mail-archive.com/qgis-developer@lists.osgeo.org/msg52302.html" target="_blank" rel="noopener">QGIS mailing list mentioned a new one called vcpkg</a> which looked very promising.</p>
<p>A couple of days later we had a build for Windows and later in the same year for macOS. With many dependencies already available in modern versions. Cheers.</p>
<p>What&rsquo;s left to do than just enable it for Android, and all our problems are suddenly solved? Alas, it&rsquo;s not so easy. <strong>Cross-compiling is always a bit trickier.</strong> And so we started another journey to improve the situation. After a while, we had a working build chain based on vcpkg for Android in our R&amp;D labs. Interestingly, this added a couple of features just because the community around vcpkg had already added them. For example using <a href="https://www.cogeo.org/" target="_blank" rel="noopener">COG</a>-based raster data via HTTP was suddenly working <em>(for the record: thanks to the availability of curl which we never took care of adding ourselves in OSGeo4A)</em>.</p>
<p>Soon after we also wanted to try building for <strong>iOS with vcpkg</strong>, which after a few attempts also was successful, and even managed to resolve some weird crashes and other issues we had experienced with the old buildchain.</p>





  




<figure class="gallery-item"><img src="/wp-content/uploads/2022/09/Peek-2022-09-19-17-01.gif" alt="" loading="lazy">
</figure>

<p>The main benefit was that we could upgrade the QGIS base libraries in one single place for every platform, in an isolated branch without playing the Jenga game on each upgrade.</p>
<p>The only unfinished business we still had was that support for iOS and Android was still available only in our own vcpkg fork.</p>
<p>So the last few weeks and months <strong>we have been working closely with upstream</strong> to bring building for Android and iOS up to the same level as desktop platforms. The relevant parts are now in a clean state.</p>
<p>Advantages of this approach:</p>
<ul>
<li>• Mutualized efforts on all the base libraries, also with programmers outside the geoverse</li>
<li>• A vibrant community that ensures a noticeably fast upgrade of libraries</li>
<li>• A clean dependency management system</li>
<li>• A consistent set of dependency versions (gdal, geos, libpq, &hellip;) across all platforms</li>
<li>• A clean caching system that will only recompile reverse dependencies on updates</li>
<li>• We can upgrade a dependency in an isolated branch and only release it when it works on all platforms</li>
<li>• We can optimize the code for a given set of dependency versions and if a bug is fixed in a certain dependency version, we are sure we can ship this fix on all platforms promptly</li>
<li>• We maintain the QField source code as well as dependency versions in a single repository, what makes development more streamlined</li>
</ul>
<p>Big thanks go to Alexander Neumann and Kai Pastor who both stand out for doing things the right and future-proof way.</p>
<p>As always, things come at a price, there was a steep learning curve involved, and some edge cases require attention. However, we are thrilled by the simplification this has brought us.</p>
<p>If you are maintaining a customized fork of QField, it is now a good time to <strong>start upgrading to vcpkg</strong>, since <a href="https://github.com/opengisch/OSGeo4A" target="_blank" rel="noopener">OSGeo4A has been archived</a> and will no longer be maintained. The <a href="https://github.com/opengisch/QField/blob/master/doc/dev.md" target="_blank" rel="noopener">developer documentation of QField</a> has been updated with relevant instructions.</p>
<p>If you have time to test the new build system, <a href="https://github.com/opengisch/QField/discussions" target="_blank" rel="noopener">we will be happy to read about your experiences</a> with it.</p>

</div>


    </div>
    <footer class="py-3 mt-auto bs-tertiary-bg" >
<hr class="m-0 p-0">

  <div class="container py-1 my-1">
    <div class="d-flex flex-wrap justify-content-between align-items-center">
      <p class="col-md mb-0 text-muted"></p>
      <ul class="nav col-md-auto justify-content-end">
        </ul>
      
    </div>
  </div>
</footer>
    





    <script src="/js/main.js" defer></script>
  


<script src="/js/dark-mode.min.56389ce981c524aae3ab3ba77bb2c7ec1d34c533bc327f161ea98d336078b79b.js" defer></script>


<script src="/js/scroll-to-top.min.f2ff2fca4c90e0d5f84752679cf4a532f250fe7d83c8441fbc1d9b80853a3294.js" defer></script>
</body>
</html>
